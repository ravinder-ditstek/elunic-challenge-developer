<div class="container">
  <p-toast></p-toast>

  <!-- Create Message Form -->
  <p-card header="Create New Message" styleClass="mb-4">
    <div class="flex gap-3 align-items-center">
      <div class="flex-1">
        <label for="newMessage" class="block mb-2 font-semibold">Message:</label>
        <input 
          id="newMessage"
          pInputText 
          type="text" 
          [(ngModel)]="newMessage" 
          placeholder="Enter your message..."
          class="w-full"
          (keyup.enter)="createMessage()"
        />
      </div>
      <div class="flex-shrink-0">
        <p-button 
          label="Create Message" 
          icon="pi pi-plus" 
          (onClick)="createMessage()"
          [loading]="creating"
          [disabled]="!newMessage.trim()"
        />
      </div>
    </div>
  </p-card>

  <!-- Messages Table -->
  <p-card header="User Messages" styleClass="mb-4">
    <p-table 
      [value]="messages" 
      [loading]="loading"
      [paginator]="false"
      [showCurrentPageReport]="false"
      styleClass="p-datatable-sm"
    >
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 80px">ID</th>
          <th>Message</th>
          <th style="width: 200px">Created Date</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-message>
        <tr>
          <td>{{ message.id }}</td>
          <td>{{ message.message }}</td>
          <td>{{ formatDate(message.created_date) }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="3" class="text-center p-4">
            <p-message severity="info" text="No messages found"></p-message>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <!-- Pagination -->
    <div class="flex justify-content-between align-items-center mt-4">
      <div class="text-sm text-gray-600">
        Showing {{ (currentPage - 1) * pageSize + 1 }} to 
        {{ Math.min(currentPage * pageSize, totalRecords) }} of {{ totalRecords }} messages
      </div>
      <p-paginator 
        [rows]="pageSize"
        [totalRecords]="totalRecords"
        [showPageLinks]="true"
        [showFirstLastIcon]="true"
        (onPageChange)="onPageChange($event)"
        [showCurrentPageReport]="false"
      ></p-paginator>
    </div>
  </p-card>
</div> 